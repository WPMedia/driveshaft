name: driveshaft
namespace: siteeng-lincoln
environments:
- name: staging
  type: ecs
  override:
    services:
      app:
        image: quay.io/washpost/driveshaft:{{ .Version }}
        ports:
          - "0:8000"
        log_driver: awslogs
        log_opt:
          awslogs-group: /nile/siteeng-lincoln/driveshaft/staging
          awslogs-region: us-east-1
        environment:
          GOOGLE_APICLIENT_SERVICEACCOUNT: '/usr/src/app/google.json'
          OPENSSL_ENCRYPTION_PASSWORD: '%{AQECAHhrXauv6cY0k3VFGkUx9UFWdvCyX3a6yFOMm4QCi5o1gwAAAIQwgYEGCSqGSIb3DQEHBqB0MHICAQAwbQYJKoZIhvcNAQcBMB4GCWCGSAFlAwQBLjARBAyDQsRDwqVoHETctuQCARCAQNEZg+uyVgVIXrUKOyzgUfV8J7l99stSZg1zgZKC211xO1ytJ7QAQtkDJaD9avTO32cPaIB6eWpUG8eWp1orOxs=}'
  services:
  - deploymentConfiguration:
      maximumPercent: 200
      minimumHealthyPercent: 50
    desiredCount: 1
    loadBalancers:
    - containerName: app
      containerPort: 8000
      loadBalancerName: se-gfx-driveshaft-staging
    serviceName: main
- name: prod
  type: ecs
  override:
    services:
      app:
        image: quay.io/washpost/driveshaft:{{ .Version }}
        ports:
          - "0:8000"
        log_driver: awslogs
        log_opt:
          awslogs-group: /nile/siteeng-lincoln/driveshaft/prod
          awslogs-region: us-east-1
        environment:
          GOOGLE_APICLIENT_SERVICEACCOUNT: '/usr/src/app/google.json'
          OPENSSL_ENCRYPTION_PASSWORD: '%{AQECAHhrXauv6cY0k3VFGkUx9UFWdvCyX3a6yFOMm4QCi5o1gwAAAIQwgYEGCSqGSIb3DQEHBqB0MHICAQAwbQYJKoZIhvcNAQcBMB4GCWCGSAFlAwQBLjARBAyDQsRDwqVoHETctuQCARCAQNEZg+uyVgVIXrUKOyzgUfV8J7l99stSZg1zgZKC211xO1ytJ7QAQtkDJaD9avTO32cPaIB6eWpUG8eWp1orOxs=}'
  services:
  - deploymentConfiguration:
      maximumPercent: 200
      minimumHealthyPercent: 50
    desiredCount: 1
    loadBalancers:
    - containerName: app
      containerPort: 8000
      loadBalancerName: se-gfx-driveshaft-prod
    serviceName: main
